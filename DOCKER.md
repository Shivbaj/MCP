# Docker Files Summary

This document summarizes all Docker-related files in the Weather MCP project.

## 🐳 Core Docker Files

### `Dockerfile`
- **Purpose**: Production container image for Weather MCP server
- **Features**: Multi-stage build, security hardening, non-root user
- **Base**: Python 3.13-slim  
- **Command**: `python main.py server --host 0.0.0.0 --port 8000`

### `docker-compose.yml`
- **Purpose**: Main orchestration file for all services
- **Services**:
  - `ollama`: Ollama LLM server (port 11434)
  - `ollama-setup`: One-time model downloader  
  - `weather-server`: Weather MCP API (port 8000)
  - `weather-demo`: Demo client (profile: demo)
- **Networks**: `weather-mcp-network`
- **Volumes**: `ollama_data` for model persistence

### `docker-compose.prod.yml`
- **Purpose**: Production overrides
- **Features**: Resource limits, security settings, health checks
- **Usage**: `docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d`

### `docker-compose.dev.yml` 
- **Purpose**: Development overrides
- **Features**: Live reload, debug logging, relaxed security
- **Usage**: `docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d`

## 📋 Configuration Files

### `.env`
- **Purpose**: Docker environment variables
- **Settings**: Server config, Ollama integration, security settings
- **Note**: Pre-configured for Docker networking (`OLLAMA_HOST=http://ollama:11434`)

### `.env.production`
- **Purpose**: Production environment template
- **Usage**: Copy from `.env.example` and customize for production

### `.dockerignore`
- **Purpose**: Exclude files from Docker build context
- **Excludes**: `__pycache__`, `.git`, development files, logs

## 🚀 Management Scripts

### `start-docker.sh`
- **Purpose**: Comprehensive startup script with options
- **Features**: Environment selection, demo mode, verbose logging
- **Usage**: `./start-docker.sh [--prod|--dev] [--demo] [--verbose] [--build]`

### `stop-docker.sh` 
- **Purpose**: Clean shutdown with cleanup options
- **Features**: Graceful stop, cleanup modes, data preservation
- **Usage**: `./stop-docker.sh [--cleanup] [--remove-data]`

### `validate-docker.sh`
- **Purpose**: Environment validation and setup
- **Features**: Docker version check, memory validation, compose wrapper
- **Usage**: `./validate-docker.sh`

## 🔧 Generated Files

### `docker-compose-wrapper.sh`
- **Purpose**: Auto-generated by `validate-docker.sh`
- **Function**: Abstracts docker-compose vs docker compose v2 differences
- **Note**: Automatically created during validation

## 📁 Directory Structure for Docker

```
weather/
├── docker-compose.yml         # Main orchestration
├── docker-compose.prod.yml    # Production overrides  
├── docker-compose.dev.yml     # Development overrides
├── Dockerfile                 # Container image definition
├── .dockerignore             # Build exclusions
├── .env                      # Docker environment config
├── .env.production           # Production template
├── start-docker.sh           # Startup script
├── stop-docker.sh            # Shutdown script
├── validate-docker.sh        # Environment validation
├── requirements.txt          # Python dependencies
└── [application files]
```

## 🌐 Network Architecture

```
Host System (localhost)
├── 8000  → weather-server:8000  (Weather API)
├── 11434 → ollama:11434         (Ollama API)
└── Docker Network: weather-mcp-network
    ├── weather-server (internal communication)
    ├── ollama (internal communication)
    ├── ollama-setup (model downloader)
    └── weather-demo (optional)
```

## 💡 Quick Reference

```bash
# Complete setup from scratch
git clone <repo> && cd weather-mcp-agent
chmod +x *.sh
./validate-docker.sh
./start-docker.sh --verbose

# Development workflow  
./start-docker.sh --dev --demo
# Make changes to code...
./start-docker.sh --dev --build  # Rebuild after changes

# Production deployment
./start-docker.sh --prod
curl http://localhost:8000/health

# Cleanup
./stop-docker.sh --cleanup
```